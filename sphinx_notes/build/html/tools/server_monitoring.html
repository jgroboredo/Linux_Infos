<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="19. PCManFM Notes" href="pcmanfm.html" /><link rel="prev" title="17. Sound on Linux Notes" href="linux_sound.html" />

    <!-- Generated with Sphinx 7.0.1 and Furo 2023.05.20 -->
        <title>18. Server Monitoring - Gonçalo&#39;s Personal Notes 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Gonçalo's Personal Notes 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Gonçalo's Personal Notes 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="sphinx.html">1. Sphinx tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="git.html">2. Git infos</a></li>
<li class="toctree-l1"><a class="reference internal" href="bash.html">3. Bash Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="lyx.html">4. LyX Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="qemu.html">5. Qemu Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="inkscape.html">6. Inkscape Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="zathura.html">7. Zathura Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="zsh.html">8. Zsh Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter.html">9. Jupyter Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pacman.html">10. Pacman Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="grub.html">11. Grub Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="vim.html">12. Vim Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">13. Python Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="libreoffice.html">14. Libreoffice Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="vscode.html">15. Code Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="nvidia.html">16. Nvidia Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_sound.html">17. Sound on Linux Notes</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">18. Server Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="pcmanfm.html">19. PCManFM Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="kde_plasma.html">20. KDE Infos - Notes on configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="handlr.html">21. Handlr Notes</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="server-monitoring">
<span id="server-monitoring-notes"></span><h1><span class="section-number">18. </span>Server Monitoring<a class="headerlink" href="#server-monitoring" title="Permalink to this heading">#</a></h1>
<p>For the monotoring of the server, I use 3 servives: grafana, influxdb (database) and telegraf.</p>
<section id="telegraf">
<h2><span class="section-number">18.1. </span>Telegraf<a class="headerlink" href="#telegraf" title="Permalink to this heading">#</a></h2>
<blockquote class="epigraph">
<div><p>Telegraf is a server-based agent for collecting and sending all metrics and events
from databases, systems, and IoT sensors. Telegraf is written in Go and compiles into a single
binary with no external dependencies, and requires a very minimal memory footprint.</p>
</div></blockquote>
<p>In order to setup telegraf, add the following to the <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">telegraf</span><span class="p">:</span>
<span class="w">  </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">telegraf</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">telegraf:1.28.5</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">HOST_MOUNT_PREFIX</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/hostfs</span>
<span class="w">    </span><span class="nt">HOST_PROC</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/hostfs/proc</span>
<span class="w">  </span><span class="c1">#devices:</span>
<span class="w">  </span><span class="c1">#  - /dev/vchiq  # For pi</span>
<span class="w">  </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">net_admin</span>
<span class="w">  </span><span class="nt">network_mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">  </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">influxdb</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${CONFIG_ROOT}/telegraf/telegraf.conf:/etc/telegraf/telegraf.conf:ro</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/:/hostfs:ro</span>
<span class="w">  </span><span class="nt">entrypoint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/bin/bash -c</span>
<span class="w">  </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;-</span>
<span class="w">    </span><span class="no">&quot;setcap cap_net_raw,cap_net_bind_service+ep /usr/bin/telegraf;</span>
<span class="w">     </span><span class="no">setcap CAP_NET_ADMIN+epi /usr/bin/telegraf;</span>
<span class="w">     </span><span class="no">groupadd -g $$(stat -c &#39;%g&#39; /var/run/docker.sock) docker;</span>
<span class="w">     </span><span class="no">usermod -a -G docker telegraf;</span>
<span class="w">     </span><span class="no">if [ -f /dev/vchiq ]; then chmod 666 /dev/vchiq; fi;</span>
<span class="w">     </span><span class="no">exec setpriv --reuid telegraf --init-groups /usr/bin/telegraf&quot;</span>
</pre></div>
</div>
<p>The other necessary setup is just the <code class="docutils literal notranslate"><span class="pre">telegraf.conf</span></code>. Note the <code class="docutils literal notranslate"><span class="pre">influxdb</span></code> url: <code class="docutils literal notranslate"><span class="pre">http://localhost:8086</span></code>.
This is required since telegraf is running in <code class="docutils literal notranslate"><span class="pre">network_mode:</span> <span class="pre">host</span></code>.</p>
<p>Finally, just setup the <code class="docutils literal notranslate"><span class="pre">organization</span></code> and <code class="docutils literal notranslate"><span class="pre">bucket</span></code> for InfluxDB as:</p>
<ul class="simple">
<li><p>organization = “xeon-metric”</p></li>
<li><p>bucket = “telegraf”</p></li>
</ul>
</section>
<section id="influxdb">
<h2><span class="section-number">18.2. </span>InfluxDB<a class="headerlink" href="#influxdb" title="Permalink to this heading">#</a></h2>
<blockquote class="epigraph">
<div><p>InfluxDB is an open-source time series database developed by the company InfluxData.
It is used for storage and retrieval of time series data in fields such as operations
monitoring, application metrics, Internet of Things sensor data, and real-time analytics.
It also has support for processing data from Graphite.
Read more in <a class="reference external" href="https://www.influxdata.com/">influxdata.com</a>.</p>
</div></blockquote>
<p>In order to setup InfluxDB, add the following to the <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">influxdb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">influxdb</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">influxdb:2.7.4</span>
<span class="w">  </span><span class="nt">env_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.env</span>
<span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PUID}:${PGID}</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">INFLUXDB_REPORTING_DISABLED</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;true&#39;</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${CONFIG_ROOT}/influxdb/config:/etc/influxdb2</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${CONFIG_ROOT}/influxdb/data:/var/lib/influxdb2</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1:8086:8086</span>
</pre></div>
</div>
<p>For the first time, in order to setup the database, set <code class="docutils literal notranslate"><span class="pre">ports</span></code> to <code class="docutils literal notranslate"><span class="pre">8086:8086</span></code> to be accessible outside the server.</p>
<p>Then, the necessary things to keep in mind are:</p>
<ul class="simple">
<li><p>Set the organization to match whatever is used in the other services: “xeon-metric”;</p></li>
<li><p>Set the bucket to match whatever is used in the other services: “telegraf”;</p></li>
<li><p>Save the token to be used both by telegraf and grafana.</p></li>
</ul>
</section>
<section id="grafana">
<h2><span class="section-number">18.3. </span>Grafana<a class="headerlink" href="#grafana" title="Permalink to this heading">#</a></h2>
<blockquote class="epigraph">
<div><p>Grafana open source software enables you to query, visualize, alert on,
and explore your metrics, logs, and traces wherever they are stored.
Grafana OSS provides you with tools to turn your time-series database (TSDB)
data into insightful graphs and visualizations. The Grafana OSS plugin
framework also enables you to connect other data sources like NoSQL/SQL
databases, ticketing tools like Jira or ServiceNow, and CI/CD tooling
like GitLab.</p>
</div></blockquote>
<p>In order to setup grafana, add the following to the <code class="docutils literal notranslate"><span class="pre">docker-compose</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">grafana</span><span class="p">:</span>
<span class="w">  </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grafana</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grafana/grafana:10.2.2</span>
<span class="w">  </span><span class="nt">env_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.env</span>
<span class="w">  </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">influxdb</span>
<span class="w">  </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PUID}:${PGID}</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;GF_SERVER_ROOT_URL=%(protocol)s://%(domain)s:%(http_port)s/grafana/&quot;</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${CONFIG_ROOT}/grafana:/var/lib/grafana</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1:3000:3000</span>
</pre></div>
</div>
<p>The first login user and password are “admin:admin”.</p>
<p>Assuming <code class="docutils literal notranslate"><span class="pre">influxdb</span></code> is already setup, go to data sources and add <code class="docutils literal notranslate"><span class="pre">influxdb</span></code> with the following parameters:</p>
<section id="influxdb-flux">
<h3><span class="section-number">18.3.1. </span>InfluxDB - Flux<a class="headerlink" href="#influxdb-flux" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Query Language: Flux</p></li>
<li><p>Url: <code class="docutils literal notranslate"><span class="pre">http://influxdb:8086</span></code></p></li>
<li><p>Basic Auth: Disabled</p></li>
<li><p>InfluxDB details:</p>
<ul>
<li><p>Organization: xeon-metric</p></li>
<li><p>Token: token from influxdb</p></li>
<li><p>Default bucket: telegraf (created by me)</p></li>
<li><p>Min time interval: 10s (default)</p></li>
<li><p>Max series: 1000 (default)</p></li>
</ul>
</li>
</ul>
<p>After clicking “Save &amp; test”, it should recognize 3 buckets.</p>
</section>
<section id="influxdb-influxql">
<h3><span class="section-number">18.3.2. </span>InfluxDB - InfluxQL<a class="headerlink" href="#influxdb-influxql" title="Permalink to this heading">#</a></h3>
<p>In InfluxDB, do the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>influxdb<span class="w"> </span>bash

<span class="c1"># To try:</span>
influx<span class="w"> </span>config<span class="w"> </span>create<span class="w"> </span>--active<span class="w"> </span>-n<span class="w"> </span>&lt;config<span class="w"> </span>name&gt;<span class="w"> </span>-u<span class="w"> </span>http://influxdb:8086<span class="w"> </span>-t<span class="w"> </span>&lt;token&gt;<span class="w"> </span>-o<span class="w"> </span>xeon-metric<span class="w"> </span><span class="c1"># -o org_id</span>
influx<span class="w"> </span>v1<span class="w"> </span>dbrp<span class="w"> </span>create<span class="w"> </span>--db<span class="w"> </span>&lt;db_name&gt;<span class="w"> </span>--rp<span class="w"> </span>autogen<span class="w"> </span>--bucket-id<span class="w"> </span>&lt;bucket_id&gt;<span class="w"> </span>--default

<span class="c1"># However, I should be able to use virtual dbrp mappings</span>
<span class="c1"># Check with:</span>
influx<span class="w"> </span>v1<span class="w"> </span>dbrp<span class="w"> </span>list

<span class="c1"># The above command outputs a telegraf database (with the same id as the bucket I created)</span>
</pre></div>
</div>
<p>After, in datasources, add the following:</p>
<ul class="simple">
<li><p>Query Language: InfluxQL</p></li>
<li><p>Url: <code class="docutils literal notranslate"><span class="pre">http://influxdb:8086</span></code></p></li>
<li><p>Add custom header:</p>
<ul>
<li><p>Header: Authorization</p></li>
<li><p>Value: Token &lt;token_here&gt;</p></li>
</ul>
</li>
<li><p>Database: telegraf (same as in <code class="docutils literal notranslate"><span class="pre">influx</span> <span class="pre">v1</span> <span class="pre">dbrp</span> <span class="pre">list</span></code>)</p></li>
<li><p>User: goncalo</p></li>
<li><p>Pw: &lt;pw&gt;</p></li>
<li><p>Get</p></li>
<li><p>Min time interval: 10s (default)</p></li>
<li><p>Max series: 1000 (default)</p></li>
</ul>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pcmanfm.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">19. </span>PCManFM Notes</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="linux_sound.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">17. </span>Sound on Linux Notes</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Gonçalo Roboredo
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">18. Server Monitoring</a><ul>
<li><a class="reference internal" href="#telegraf">18.1. Telegraf</a></li>
<li><a class="reference internal" href="#influxdb">18.2. InfluxDB</a></li>
<li><a class="reference internal" href="#grafana">18.3. Grafana</a><ul>
<li><a class="reference internal" href="#influxdb-flux">18.3.1. InfluxDB - Flux</a></li>
<li><a class="reference internal" href="#influxdb-influxql">18.3.2. InfluxDB - InfluxQL</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    </body>
</html>